<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Basic Calculator</title>
  <style>
    :root{--bg:#f3f4f6;--panel:#ffffff;--accent:#6c5ce7;--muted:#7b7f87}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, Arial, sans-serif;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#e9f0ff 0%,#f7f7fb 100%);padding:24px;margin:0}
    .calc{width:340px;background:var(--panel);border-radius:16px;box-shadow:0 8px 30px rgba(20,20,40,.08);overflow:hidden}
    .display{padding:18px 16px;background:linear-gradient(180deg,#fbfdff,#f7f9ff);border-bottom:1px solid #eef2ff}
    .expr{color:var(--muted);font-size:14px;height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .value{font-size:32px;font-weight:600;padding-top:6px;word-break:break-all}
    .keys{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;padding:16px}
    button{appearance:none;border:0;padding:14px;border-radius:10px;font-size:18px;cursor:pointer;user-select:none}
    .btn-operator{background:linear-gradient(180deg,#f4f6ff,#eef2ff);color:#1f2d5b}
    .btn-num{background:#f8fafc}
    .btn-equal{grid-column:span 2;background:linear-gradient(90deg,var(--accent),#4e34c8);color:white;font-weight:700}
    .btn-action{background:#fff6f0;color:#c1541a}
    .btn-wide{grid-column:span 2}
    button:active{transform:translateY(1px)}
    .muted{opacity:.8;font-size:12px;text-align:center;padding:8px;color:#6b7280}
    @media (max-width:380px){.calc{width:100%}}
  </style>
</head>
<body>
  <main class="calc" role="application" aria-label="Basic calculator">
    <div class="display">
      <div class="expr" id="expr">&nbsp;</div>
      <div class="value" id="value">0</div>
    </div>

    <section class="keys" role="grid">
      <button class="btn-action" data-action="clear" title="Clear (Esc)">C</button>
      <button class="btn-action" data-action="back" title="Backspace (Backspace)">⌫</button>
      <button class="btn-action" data-action="percent" title="Percent">%</button>
      <button class="btn-operator" data-op="/" title="Divide">÷</button>

      <button class="btn-num" data-num="7">7</button>
      <button class="btn-num" data-num="8">8</button>
      <button class="btn-num" data-num="9">9</button>
      <button class="btn-operator" data-op="*" title="Multiply">×</button>

      <button class="btn-num" data-num="4">4</button>
      <button class="btn-num" data-num="5">5</button>
      <button class="btn-num" data-num="6">6</button>
      <button class="btn-operator" data-op="-" title="Subtract">−</button>

      <button class="btn-num" data-num="1">1</button>
      <button class="btn-num" data-num="2">2</button>
      <button class="btn-num" data-num="3">3</button>
      <button class="btn-operator" data-op="+" title="Add">+</button>

      <button class="btn-num btn-wide" data-num="0">0</button>
      <button class="btn-num" data-num=".">.</button>
      <button class="btn-equal" data-action="equals" title="Equals">=</button>
    </section>

    <div class="muted">Keyboard: numbers, + - * /, Enter (=), Backspace, Esc (clear)</div>
  </main>

  <script>
    (function(){
      const exprEl = document.getElementById('expr');
      const valueEl = document.getElementById('value');

      let current = '0';
      let previous = null;
      let operator = null;
      let justEvaluated = false;

      function refresh(){
        valueEl.textContent = current;
        exprEl.textContent = previous ? (previous + ' ' + (operator||'') ) : '';
      }

      function inputDigit(d){
        if(justEvaluated){ current = '0'; justEvaluated = false }
        if(d === '.' && current.includes('.')) return;
        if(current === '0' && d !== '.') current = d;
        else current = current + d;
        refresh();
      }

      function applyOperator(op){
        if(operator && previous !== null && !justEvaluated){
          compute();
        } else {
          previous = current;
        }
        operator = op;
        justEvaluated = false;
        current = '0';
        refresh();
      }

      function compute(){
        if(previous === null || operator === null) return;
        const a = parseFloat(previous);
        const b = parseFloat(current);
        let res = 0;
        switch(operator){
          case '+': res = a + b; break;
          case '-': res = a - b; break;
          case '*': res = a * b; break;
          case '/':
            if(b === 0){ alert('Cannot divide by zero'); reset(); return; }
            res = a / b; break;
          default: return;
        }
        // avoid floating point ugliness
        res = parseFloat(res.toPrecision(12));
        current = String(res);
        previous = null;
        operator = null;
        justEvaluated = true;
        refresh();
      }

      function percent(){
        current = String(parseFloat(current)/100);
        refresh();
      }

      function reset(){ current='0'; previous=null; operator=null; justEvaluated=false; refresh(); }

      function backspace(){
        if(justEvaluated){ reset(); return }
        if(current.length <= 1){ current = '0' }
        else current = current.slice(0,-1);
        refresh();
      }

      document.querySelectorAll('[data-num]').forEach(b=>{
        b.addEventListener('click', ()=> inputDigit(b.dataset.num));
      });
      document.querySelectorAll('[data-op]').forEach(b=>{
        b.addEventListener('click', ()=> applyOperator(b.dataset.op));
      });
      document.querySelectorAll('button[data-action]').forEach(b=>{
        b.addEventListener('click', ()=>{
          const a = b.dataset.action;
          if(a === 'clear') reset();
          if(a === 'back') backspace();
          if(a === 'equals') compute();
          if(a === 'percent') percent();
        });
      });

      // Keyboard support
      window.addEventListener('keydown', (e)=>{
        if(e.key >= '0' && e.key <= '9'){ inputDigit(e.key); e.preventDefault(); return }
        if(e.key === '.') { inputDigit('.'); e.preventDefault(); return }
        if(['+','-','*','/'].includes(e.key)){ applyOperator(e.key); e.preventDefault(); return }
        if(e.key === 'Enter'){ compute(); e.preventDefault(); return }
        if(e.key === 'Backspace'){ backspace(); e.preventDefault(); return }
        if(e.key === 'Escape'){ reset(); e.preventDefault(); return }
        if(e.key === '%'){ percent(); e.preventDefault(); return }
      });

      // initialize
      refresh();
    })();
  </script>
</body>
</html>
